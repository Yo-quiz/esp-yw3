const yoKaiList = [
  { "name": "Robin Ful", "img": "Robin_Ful.png" },
  { "name": "Tornalmohado", "img": "Tornalmohado.png" },
  { "name": "Gran Coco", "img": "Gran_Coco.png" },
  { "name": "Minimoto", "img": "Minimoto.png" },
  { "name": "Bola Blanda", "img": "Bola_Blanda.png" },
  { "name": "Bateadós", "img": "Bateados.png" },
  { "name": "Chupapremios", "img": "Chupapremios.png" },
  { "name": "Guerrero Güey", "img": "Guerrero_Guey.png" },
  { "name": "Huracán Güey", "img": "Huracan_Guey.png" },
  { "name": "Barbacoo", "img": "Barbacoo.png" },
  { "name": "Piopío Yonohesido", "img": "Piopio_Yonohesido.png" },
  { "name": "Globonauta", "img": "Globonauta.png" },
  { "name": "Shurikenny", "img": "Shurikenny.png" },
  { "name": "Nunchucky", "img": "Nunchucky.png" },
  { "name": "Camelia", "img": "Camelia.png" },
  { "name": "Cremallero", "img": "Cremallero.png" },
  { "name": "Metepatas", "img": "Metepatas.png" },
  { "name": "Mochueloqué", "img": "Mochueloque.png" },
  { "name": "Todoídos", "img": "Todoidos.png" },
  { "name": "Preguntio", "img": "Preguntio.png" },
  { "name": "Respondio", "img": "Respondio.png" },
  { "name": "Exitio", "img": "Exitio.png" },
  { "name": "Cachocarne", "img": "Cachocarne.png" },
  { "name": "Mazorco", "img": "Mazorco.png" },
  { "name": "Cascarito", "img": "Cascarito.png" },
  { "name": "Pomponio Gala", "img": "Pomponio_Gala.png" },
  { "name": "Fiestuki", "img": "Fiestuki.png" },
  { "name": "Calaveroscopio", "img": "Calaveroscopio.png" },
  { "name": "Leongüista", "img": "Leonguista.png" },
  { "name": "Estatiniño", "img": "Estatinino.png" },
  { "name": "Profesor Avertijo", "img": "Profesor_Avertijo.png" },
  { "name": "Noaipapel", "img": "Noaipapel.png" },
  { "name": "Jipigenio", "img": "Jipigenio.png" },
  { "name": "Miss Teria", "img": "Miss_Teria.png" },
  { "name": "Renaldo", "img": "Renaldo.png" },
  { "name": "Isotomas", "img": "Isotomas.png" },
  { "name": "Coneagente", "img": "Coneagente.png" },
  { "name": "Blancacone", "img": "Blancacone.png" },
  { "name": "Prudencio", "img": "Prudencio.png" },
  { "name": "Explotacota", "img": "Explotacota.png" },
  { "name": "Grafilcebú", "img": "Grafilcebu.png" },
  { "name": "Chocovaca", "img": "Chocovaca.png" },
  { "name": "Vacaloca", "img": "Vacaloca.png" },
  { "name": "Fracalavero", "img": "Fracalavero.png" },
  { "name": "Calabilidoso", "img": "Calabilidoso.png" },
  { "name": "Master Chof", "img": "Master_Chof.png" },
  { "name": "Monte Merario", "img": "Monte_Merario.png" },
  { "name": "Calmarinero", "img": "Calmarinero.png" },
  { "name": "Almirante Admirable", "img": "Almirante_Admirable.png" },
  { "name": "Peter Punki", "img": "Peter_Punki.png" },
  { "name": "Pantuflo", "img": "Pantuflo.png" },
  { "name": "Reahucio", "img": "Reahucio.png" },
  { "name": "Radiopatio", "img": "Radiopatio.png" },
  { "name": "Filete II", "img": "Filete_II.png" },
  { "name": "Showbonyan", "img": "Showbonyan.png" },
  { "name": "Tiburon Tiburcio", "img": "Tiburon_Tiburcio.png" },
  { "name": "Tiburon Jaqueton", "img": "Tiburon_Jaqueton.png" },
  { "name": "Capitan Nublo", "img": "Capitan_Nublo.png" },
  { "name": "Sincopollo", "img": "Sincopollo.png" },
  { "name": "Brownilda", "img": "Brownilda.png" },
  { "name": "Chapulin", "img": "Chapulin.png" },
  { "name": "Apanleado", "img": "Apanleado.png" },
  { "name": "Panduro", "img": "Panduro.png" },
  { "name": "Superniñato", "img": "Superninato.png" },
  { "name": "Superniñato Rebelde", "img": "Superninato_Rebelde.png" },
  { "name": "Superniñato Picajoso", "img": "Superninato_Picajoso.png" },
  { "name": "BellonZ", "img": "BellonZ.png" },
  { "name": "Olvirunner", "img": "Olvirunner.png" },
  { "name": "Gatallanes", "img": "Gatallanes.png" },
  { "name": "Limonescente", "img": "Limonescente.png" },
  { "name": "Tomanota", "img": "Tomanota.png" },
  { "name": "Zalameria", "img": "Zalameria.png" },
  { "name": "Jibanyan Liu Bei", "img": "Jibanyan_Liu_Bei.png" },
  { "name": "Komasan Sun Ce", "img": "Komasan_Sun_Ce.png" },
  { "name": "Todoapesta", "img": "Todoapesta.png" },
  { "name": "Relapache", "img": "Relapache.png" },
  { "name": "Cafechucho", "img": "Cafechucho.png" },
  { "name": "Partidacio", "img": "Partidacio.png" },
  { "name": "Tomnyan", "img": "Tomnyan.png" },
  { "name": "Komaestopistas", "img": "Komaestopistas.png" },
  { "name": "Segadora", "img": "Segadora.png" },
  { "name": "Chocobonyan", "img": "Chocobonyan.png" },
  { "name": "Mogurinyan", "img": "Mogurinyan.png" },
  { "name": "Wobblenyan", "img": "Wobblenyan.png" },
  { "name": "Wibblekoma", "img": "Wibblekoma.png" },
  { "name": "Sushinyan", "img": "Sushinyan.png" },
  { "name": "Tempurasan", "img": "Tempurasan.png" },
  { "name": "Tenguriginal", "img": "Tenguriginal.png" },
  { "name": "Angel Garudian", "img": "Angel_Garudian.png" },
  { "name": "Lenaciegotxea", "img": "Lenaciegotxea.png" },
  { "name": "Chunda y Tachunda", "img": "Chunda_y_Tachunda.png" },
  { "name": "Abuzampa XXL", "img": "Abuzampa_XXL.png" },
  { "name": "Albornocita Azul", "img": "Albornocita_Azul.png" },
  { "name": "Florentina", "img": "Florentina.png" },
  { "name": "Afronauta", "img": "Afronauta.png" },
  { "name": "Arrocet", "img": "Arrocet.png" },
  { "name": "Espe", "img": "Espe.png" },
  { "name": "Bellotieso", "img": "Bellotieso.png" },
  { "name": "Clican", "img": "Clican.png" },
  { "name": "Indeciguro", "img": "Indeciguro.png" },
  { "name": "Trabalanghi", "img": "Trabalanghi.png" },
  { "name": "Dormidomingo", "img": "Dormidomingo.png" },
  { "name": "Auxiliadora", "img": "Auxiliadora.png" },
  { "name": "Abuflauta", "img": "Abuflauta.png" },
  { "name": "Gememinencias", "img": "Gememinencias.png" },
  { "name": "Repostilleja", "img": "Repostilleja.png" },
  { "name": "Gogonzalo", "img": "Gogonzalo.png" },
  { "name": "Esmaltina", "img": "Esmaltina.png" },
  { "name": "Fantasfitriona", "img": "Fantasfitriona.png" },
  { "name": "Sonico", "img": "Sonico.png" },
  { "name": "Supersonico", "img": "Supersonico.png" },
  { "name": "Berenpenas", "img": "Berenpenas.png" },
  { "name": "Akusika", "img": "Akusika.png" },
  { "name": "Leonerai", "img": "Leonerai.png" },
  { "name": "Trenditopico", "img": "Trenditopico.png" },
  { "name": "Retuiterio", "img": "Retuiterio.png" },
  { "name": "Panceto", "img": "Panceto.png" },
  { "name": "Bilgatino", "img": "Bilgatino.png" },
  { "name": "Su Hackeltad", "img": "Su_Hackeltad.png" },
  { "name": "Rey Pulsivo", "img": "Rey_Pulsivo.png" },
  { "name": "Timo Gallo", "img": "Timo_Gallo.png" },
  { "name": "Rocky Malrolla", "img": "Rocky_Malrolla.png" },
  { "name": "Hierodista", "img": "Hierodista.png" },
  { "name": "Herrato", "img": "Herrato.png" },
  { "name": "MC Kappa", "img": "MC_Kappa.png" },
  { "name": "Tumbardillo", "img": "Tumbardillo.png" },
  { "name": "Usapyon Zhongda", "img": "Usapyon_Zhongda.png" },
  { "name": "Dr. Nihil Listo", "img": "Dr_Nihil_Listo.png" },
  { "name": "Dr. Nocturnia", "img": "Dr_Nocturnia.png" },
  { "name": "Espaya", "img": "Espaya.png" },
  { "name": "Corbapacasa", "img": "Corbapacasa.png" },
  { "name": "Cartairada", "img": "Cartairada.png" },
  { "name": "Ambivalencio", "img": "Ambivalencio.png" },
  { "name": "Lapo", "img": "Lapo.png" },
  { "name": "Dabombo", "img": "Dabombo.png" },
  { "name": "Los Bomboledores", "img": "Los_Bomboledores.png" },
  { "name": "Amarilia", "img": "Amarilia.png" },
  { "name": "Sheriff Agonio", "img": "Sheriff_Agonio.png" },
  { "name": "Padefo", "img": "Padefo.png" },
  { "name": "Sololo", "img": "Sololo.png" },
  { "name": "Maracario", "img": "Maracario.png" },
  { "name": "Pandalon", "img": "Pandalon.png" },
  { "name": "Peluson", "img": "Peluson.png" },
  { "name": "Amarguito", "img": "Amarguito.png" },
  { "name": "Nauseo", "img": "Nauseo.png" },
  { "name": "Condespotico", "img": "Condespotico.png" },
  { "name": "Flequipilante", "img": "Flequipilante.png" },
  { "name": "Origenio", "img": "Origenio.png" },
  { "name": "Horrogenio", "img": "Horrogenio.png" },
  { "name": "Fulgurilla", "img": "Fulgurilla.png" },
  { "name": "Saltetera", "img": "Saltetera.png" },
  { "name": "Don Despacito", "img": "Don_Despacito.png" },
  { "name": "Sierpesado", "img": "Sierpesado.png" },
  { "name": "Cobravil", "img": "Cobravil.png" },
  { "name": "Aymadrilo", "img": "Aymadrilo.png" },
  { "name": "Naqueperder", "img": "Naqueperder.png" },
  { "name": "Borjamar", "img": "Borjamar.png" },
  { "name": "Bebesaurio", "img": "Bebesaurio.png" },
  { "name": "Destrozasaurio", "img": "Destrozasaurio.png" },
  { "name": "Torpesaurio", "img": "Torpesaurio.png" },
  { "name": "Luigi Longueras", "img": "Luigi_Longueras.png" },
  { "name": "Pulpopular", "img": "Pulpopular.png" },
  { "name": "Tentanfadado", "img": "Tentanfadado.png" },
  { "name": "Tochacolate", "img": "Tochacolate.png" },
  { "name": "Sustoleo", "img": "Sustoleo.png" },
  { "name": "Reptozudo", "img": "Reptozudo.png" },
  { "name": "Saporientador", "img": "Saporientador.png" },
  { "name": "Originyan", "img": "originyan.gif" },
  { "name": "Aydroide Y", "img": "Aydroide_Y.png" },
  { "name": "Rey Jibanyan", "img": "Rey_Jibanyan.png" },
  { "name": "Reina Usapyon", "img": "Reina_Usapyon.png" },
  { "name": "Jotamasan", "img": "Jotamasan.png" },
  { "name": "Diez de Komajiro", "img": "Diez_de_Komajiro.png" },
  { "name": "Asnyan", "img": "Asnyan.png" },
  { "name": "Whismodin", "img": "Whismodin.png" },
  { "name": "Benzaiten", "img": "Benzaiten.png" },
  { "name": "Hotei", "img": "Hotei.png" },
  { "name": "Daikokuten", "img": "Daikokuten.png" },
  { "name": "Ebisu", "img": "Ebisu.png" },
  { "name": "Bishamonten", "img": "Bishamonten.png" },
  { "name": "Gatobal Colon", "img": "Gatobal_Colon.png" },
  { "name": "T. Energison", "img": "T_Energison.png" },
  { "name": "Darguin", "img": "Darguin.png" },
  { "name": "Ultimo Nyanmurai", "img": "Ultimo_Nyanmurai.png" },
  { "name": "Koma Estrella", "img": "Koma_Estrella.png" },
  { "name": "Platinum", "img": "Platinum.png" },
  { "name": "Abusplendido", "img": "Abusplendido.png" },
  { "name": "Re-Q-Pera", "img": "Re-Q-Pera.png" },
  { "name": "Divamarina", "img": "Divamarina.png" },
  { "name": "Todobelicoso", "img": "Todobelicoso.png" },
  { "name": "Terminyanator", "img": "Terminyanator.png" },
  { "name": "Supernyan", "img": "Supernyan.png" },
  { "name": "Hovernyan S", "img": "Hovernyan_S.png" },
  { "name": "Hovernyan Cao Cao", "img": "Hovernyan_Cao_Cao.png" },
  { "name": "Yoguididacta", "img": "Yoguididacta.png" },
  { "name": "Frauduralla", "img": "Frauduralla.png" },
  { "name": "Insaciablo", "img": "Insaciablo.png" },
  { "name": "Penancio", "img": "Penancio.png" },
  { "name": "Venoctobot", "img": "Venoctobot.png" },
  { "name": "Demoniorco Lu Bu", "img": "Demoniorco_Lu_Bu.png" },
  { "name": "Kyubot", "img": "Kyubot.png" },
  { "name": "Robonyan Definitivo", "img": "Robonyan_Definitivo.png" },
  { "name": "Topiña", "img": "Topina.png" },
  { "name": "Miss Mousse", "img": "Miss_Mousse.png" },
  { "name": "Populina", "img": "populina.gif" },
  { "name": "Koalanyan", "img": "Koalanyan.png" },
  { "name": "Jibanyan T", "img": "jibanyan_T.gif" },
  { "name": "Komasan T", "img": "komasan_T.gif" },
  { "name": "Yemajestad", "img": "Yemajestad.png" },
  { "name": "Cicloman", "img": "Cicloman.png" },
  { "name": "Deporchugo", "img": "Deporchugo.png" },
  { "name": "Timorato Buendia", "img": "Timorato_Buendia.png" },
  { "name": "Maripasada", "img": "Maripasada.png" },
  { "name": "Ulteria", "img": "Ulteria.png" },
  { "name": "Milperdones", "img": "Milperdones.png" },
  { "name": "Angustianima", "img": "Angustianima.png" },
  { "name": "Cutremomia", "img": "Cutremomia.png" },
  { "name": "Kapman", "img": "Kapman.png" },
  { "name": "Tofupyon", "img": "Tofupyon.png" },
  { "name": "Dex Capito", "img": "Dex_Capito.png" },
  { "name": "Embajador Fabuloso", "img": "Embajador_Fabuloso.png" },
  { "name": "Intelecto", "img": "Intelecto_A.png" },
  { "name": "Zazel", "img": "Zazel_A.png" },
  { "name": "Procrastinocho", "img": "Procrastinocho.png" },
  { "name": "Cofre Cafre", "img": "Cofre_Cafre.png" },
  { "name": "Coco Masiel", "img": "Coco_Masiel.png" },
  { "name": "Whisper Kongming", "img": "Whisper_Kongming.png" },
  { "name": "Jurojin", "img": "Jurojin.png" },
  { "name": "Fukurokuju", "img": "Fukurokuju.png" },
  { "name": "Maldenotep", "img": "Maldenotep.png" },
  { "name": "Rey Palmiro", "img": "Rey_Palmiro.png" },
  { "name": "Pandora", "img": "Pandora.png" },
  { "name": "Ingenio", "img": "Ingenio.png" },
  { "name": "Bastenyan", "img": "Bastenyan.png" },
  { "name": "Komanubis", "img": "Komanubis.png" },
  { "name": "Discursi", "img": "Discursi.png" },
  { "name": "Educoso", "img": "Educoso.png" },
  { "name": "Lord Pedigri", "img": "Lord_Pedigri.png" },
  { "name": "Urbasierpe", "img": "Urbasierpe.png" },
  { "name": "Pregundragon Rey", "img": "Pregundragon_Rey.png" },
  { "name": "Zazel Justiciero", "img": "Zazel_Justiciero.png" },
  { "name": "Intelecto Iluminado", "img": "Intelecto_Iluminado_A.png" },
  { "name": "Enma Ancestral", "img": "Enma_Ancestral.png" },
  { "name": "Gran Enma Iluminado", "img": "Gran_Enma_Iluminado.png" },
  { "name": "Rollaculo", "img": "Rollaculo.png" },
  { "name": "Maharazas", "img": "Maharazas.png" },
  { "name": "Cimbalina", "img": "Cimbalina.png" },
  { "name": "Masculloso", "img": "Masculloso.png" },
  { "name": "Vociferio", "img": "Vociferio.png" },
  { "name": "Aviguito Pio", "img": "Aviguito_Pio.png" },
  { "name": "Frustrolillo", "img": "Frustrolillo.png" },
  { "name": "Bovida", "img": "Bovida.png" },
  { "name": "Equinio", "img": "Equinio.png" },
  { "name": "Pecificador", "img": "Pecificador.png" },
  { "name": "Alpina", "img": "Alpina.png" },
  { "name": "Seleno", "img": "Seleno.png" },
  { "name": "KJ", "img": "KJ.png" },
  { "name": "Enma Solar", "img": "Enma_Solar.png" },
  { "name": "Enma Infinito", "img": "Enma_Infinito.png" },
  { "name": "Enma Umbrio", "img": "Enma_Umbrio.png" },
  { "name": "Tibu Jones", "img": "tibu_Jones.gif" },
  { "name": "Vulcavador", "img": "vulcavador.gif" },
  { "name": "Adoleszombi", "img": "adoleszombi.gif" },
  { "name": "Nyanses II", "img": "nyanses_II.gif" },
  { "name": "Miopatra", "img": "Miopatra.png" },
  { "name": "Mazado de la Calzada", "img": "mazado_de_la_Calzada.gif" },
  { "name": "Dradorado", "img": "Dradorado.png" },
  { "name": "Fenixtelecto", "img": "Fenixtelecto.png" },
  { "name": "Chatarrenstein", "img": "Chatarrenstein.png" },
  { "name": "Supergerente", "img": "Supergerente.png" },
  { "name": "Ilusionisto", "img": "Ilusionisto.png" },
  { "name": "Camorro", "img": "Camorro.png" },
  { "name": "Diavolo", "img": "Diavolo.png" },
  { "name": "Flautista de Malmelin", "img": "Flautista_de_Malmelin.png" },
  { "name": "Gamero", "img": "Gamero.png" },
  { "name": "Yopple-Bot", "img": "Yopple-Bot.png" },
  { "name": "No-Bot", "img": "No-Bot.png" },
  { "name": "Nocturnia", "img": "Nocturnia.png" },
  { "name": "Ray Baqueto", "img": "Ray_Baqueto.png" },
  { "name": "Don Crueleone", "img": "Don_Crueleone.png" },
  { "name": "Don Conspirazione", "img": "Don_Conspirazione.png" },
  { "name": "Flautiscolito", "img": "Flautiscolito.png" },
  { "name": "Duocolito", "img": "Duocolito.png" },
  { "name": "Cantacolito", "img": "Cantacolito.png" },
  { "name": "Ciclonojo", "img": "Ciclonojo.png" },
  { "name": "Caballero Hueco", "img": "Caballero_Hueco.png" },
  { "name": "Paticio", "img": "Paticio.png" },
  { "name": "Demoniorcolito", "img": "Demoniorcolito.png" },
  { "name": "Iluminazen", "img": "Iluminazen.png" },
  { "name": "Capitan Botin", "img": "Capitan_Botin.png" },
  { "name": "Chef Ricote", "img": "Chef_Ricote.png" },
  { "name": "Doncella de la Ruina", "img": "Doncella_de_la_Ruina.png" },
  { "name": "Necrocobra", "img": "Necrocobra.png" },
  { "name": "Don Aureone", "img": "Don_Aureone.png" },
  { "name": "Icarus", "img": "Icarus.png" },
  { "name": "Ballenato", "img": "Ballenato.png" },
  { "name": "Cachaslote", "img": "Cachaslote.png" },
  { "name": "El Carnicero", "img": "El_Carnicero.png" },
  { "name": "Topoderoso", "img": "Topoderoso.png" },
  { "name": "El Ultimisimo Nyanmurai", "img": "El_Ultimisimo_Nyanmurai.png" },
]

let score = 0; 
let gameEnded = false; // Evita cambios una vez terminado el juego
const unlockedYoKai = new Set(); // Registro de Yo-kai desbloqueados por índice

// Normalizar la entrada del usuario (sin tildes y en minúsculas)
function normalizeString(str) {
    return str.normalize("NFD").replace(/[̀-\u036f]/g, "").toLowerCase();
}

// Crear el objeto de audio una sola vez
let getSound = new Audio("get.mp3");

// Reproducir sonido cuando se desbloquea un Yo-kai (sin solapamiento)
function playGetSound() {
    if (!getSound.paused) {
        getSound.pause(); // Detener el sonido actual si ya está reproduciéndose
        getSound.currentTime = 0; // Reiniciar el sonido al principio
    }
    getSound.play(); // Reproducir el sonido
}

// Actualizar la puntuación en formato (adivinados / totales)
function updateScoreDisplay() {
    const scoreDisplay = document.getElementById("score");
    scoreDisplay.textContent = `${score}/${yoKaiList.length}`;
}

// Verificar la respuesta del usuario
function checkAnswer() {
    if (gameEnded) return; // Si el juego ha terminado, no hacer nada

    const userAnswer = normalizeString(document.getElementById("answer-input").value.trim());

    let correctGuess = false; // Bandera para reproducir el sonido solo si hay aciertos

    yoKaiList.forEach((yoKai, index) => {
        // Normaliza todos los nombres asociados al Yo-kai
        const normalizedNames = [yoKai.name, ...(yoKai.aliases || [])].map(name => normalizeString(name));

        // Si la respuesta coincide con alguno de los nombres y no ha sido desbloqueado
        if (normalizedNames.includes(userAnswer) && !unlockedYoKai.has(index)) {
            const yoKaiImg = document.getElementById(`yo-kai${index + 1}`);
            if (yoKaiImg && yoKaiImg.src.includes("no-kai.png")) {
                yoKaiImg.src = yoKai.img; // Actualiza la imagen

                // Añadir clase para animación
                yoKaiImg.classList.add("yokai-unlocked");
                yoKaiImg.addEventListener("animationend", () => {
                    yoKaiImg.classList.remove("yokai-unlocked"); // Quitar clase tras animación
                });

                unlockedYoKai.add(index); // Marcar el Yo-kai como desbloqueado
                score++;
                correctGuess = true; // Se encontró un acierto
            }
        }
    });

    if (correctGuess) {
        playGetSound(); // Reproducir sonido solo si hubo un acierto
        updateScoreDisplay(); // Actualizar puntuación
        document.getElementById("answer-input").value = ""; // Borra la respuesta después de un acierto
    }

    checkGameEnd(); // Verifica si el juego ha terminado
}

// Verificar si el juego ha terminado (cuando se han adivinado todos los Yo-kai)
function checkGameEnd() {
    if (score === yoKaiList.length) {
        gameEnded = true;
        stopTimer(); // Detener el temporizador
        showCongratsImage(); // Mostrar imagen de "¡Felicidades!"
    }
}

// Mostrar la imagen de "¡Felicidades!" al finalizar el juego
function showCongratsImage() {
    const congratsImg = document.createElement("img");
    congratsImg.src = "congrats.png";
    congratsImg.id = "congrats-image";
    congratsImg.style.position = "fixed";
    congratsImg.style.bottom = "0";
    congratsImg.style.left = "50%";
    congratsImg.style.transform = "translateX(-50%)";
    congratsImg.style.width = "100vw";
    congratsImg.style.zIndex = "1000";
    congratsImg.style.cursor = "pointer";

    // Ocultar la imagen al hacer clic
    congratsImg.addEventListener("click", () => {
        congratsImg.remove();
    });

    document.body.appendChild(congratsImg);
}

// Temporizador
let startTime;
let timerInterval;

function startTimer() {
    startTime = Date.now();
    timerInterval = setInterval(updateTimer, 1000);
}

function updateTimer() {
    const currentTime = Date.now();
    const elapsedTime = currentTime - startTime;

    const hours = Math.floor(elapsedTime / (1000 * 60 * 60));
    const minutes = Math.floor((elapsedTime % (1000 * 60 * 60)) / (1000 * 60));
    const seconds = Math.floor((elapsedTime % (1000 * 60)) / 1000);

    const formattedTime = `${String(hours).padStart(2, "0")}:${String(minutes).padStart(2, "0")}:${String(seconds).padStart(2, "0")}`;
    document.getElementById("time").textContent = formattedTime;
}

function stopTimer() {
    clearInterval(timerInterval);
}

// Manejador de evento: validación automática con "input"
document.getElementById("answer-input").addEventListener("input", checkAnswer);

// Inicializar el marcador y temporizador al cargar la página
updateScoreDisplay(); // Inicializa la puntuación en 0/total
startTimer();

window.addEventListener("beforeunload", (event) => {
    if (score > 0) { // Mostrar advertencia solo si hay progreso
        event.preventDefault();
        event.returnValue = "¿Estás seguro de que quieres salir? Se perderá todo el progreso.";
    }
});
